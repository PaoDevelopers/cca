{{ define "title" }}
Grades
{{ end }}

{{ define "content" }}
<section class="intro">
<p>
Grades are groups of students. Each student may only be assigned one
grade.
</p>
<p>
Some example grades include
&ldquo;Year 9&rdquo;,
&ldquo;Year 12&rdquo;,
etc.
</p>
<p>
On this page you may define a set of grades up-front;
in the students tab, you may reference these grades.
</p>
<p>
Each grade has an &ldquo;enabled&rdquo;/&ldquo;disabled&ldquo;
status, which indicates whether students of that grade
may alter their choices.
</p>
<p>
The &ldquo;edit&rdquo; form of each grade also allows you to define the
minimum number of courses from arbitrary sets of categories that students
in that grade must satisfy.
</p>
</section>
{{ $categories := .Categories }}
<section class="listing">
<h2>Current grades</h2>
<div class="cards-grid">
{{ range .Grades }}
<article class="card">
<header class="card-header hfill"><span>{{ .Grade }}</span><span>{{ if .Enabled }}Enabled{{ else }}Disabled{{ end }}</span></header>
<div>
<p>Max own selections: {{ .MaxOwnChoices }}</p>
{{ if .ReqGroups }}
<ul class="card-list">
{{ range .ReqGroups }}
<li class="card-list-item">
<span>At least {{ .MinCount }} from {{ .CategoryIds }}</span>
<form method="POST" action="/admin/grades/delete-requirement-group" class="stack-form">
<input type="hidden" name="id" value="{{ .ID }}" />
<div class="form-actions">
<button type="submit">Remove</button>
</div>
</form>
</li>
{{ end }}
</ul>
{{ end }}
</div>
<details>
<summary>Add requirement group</summary>
<form method="POST" action="/admin/grades/new-requirement-group" class="stack-form">
<input type="hidden" name="grade" value="{{ .Grade }}" />
<div class="form-field">
<label for="mincount-new-{{ .Grade }}">Minimum count</label>
<input id="mincount-new-{{ .Grade }}" type="number" min="0" max="65535" step="1" name="min_count" />
</div>
<fieldset class="checkbox-group">
<legend>Categories</legend>
{{ $grade := .Grade }}
{{ range $categories }}
<div class="checkbox-option">
<input type="checkbox" id="category-{{ . }}-{{ $grade }}" value="{{ . }}" name="category-{{ . }}" />
<label for="category-{{ . }}-{{ $grade }}">{{ . }}</label>
</div>
{{ end }}
</fieldset>
<div class="form-actions">
<button type="submit">Add group</button>
</div>
</form>
</details>
<details>
<summary>Actions</summary>
<form method="POST" action="/admin/grades/delete" class="stack-form">
<input type="hidden" name="grade" value="{{ .Grade }}" />
<div class="form-actions">
<button type="submit">Delete</button>
</div>
</form>
</details>
</article>
{{ end }}
</div>
</section>
<section class="new">
<h2>New grade</h2>
<form method="POST" action="/admin/grades/new" class="stack-form">
<div class="form-field">
<label for="new-grade-grade">Grade</label>
<input type="text" id="new-grade-grade" name="grade" required />
</div>
<div class="form-actions">
<button type="submit">Add</button>
</div>
</form>
</section>
<section class="listing">
<h2>Bulk-update grade settings</h2>
<form method="POST" action="/admin/grades/bulk-enabled-update" class="stack-form">
{{ range $idx, $grade := .Grades }}
<fieldset class="bulk-grade">
<legend>{{ $grade.Grade }}</legend>
<input type="hidden" name="grade[]" value="{{ $grade.Grade }}" />
<div class="checkbox-option">
<input type="checkbox" id="bulk-enabled-{{ $idx }}" value="{{ $grade.Grade }}" name="enabled[]" {{ if $grade.Enabled }}checked{{ end }} />
<label for="bulk-enabled-{{ $idx }}">Enabled</label>
</div>
<div class="form-field">
<label for="bulk-max-own-{{ $idx }}">Max own selections</label>
<input type="number" id="bulk-max-own-{{ $idx }}" name="max_own_choices[]" min="0" step="1" value="{{ $grade.MaxOwnChoices }}" required />
</div>
</fieldset>
{{ end }}
<div class="form-actions">
<button type="submit">Bulk update</button>
</div>
</form>
</section>
{{ end }}
