{{ define "title" }}
Students
{{ end }}

{{ define "content" }}
<section class="intro">
<p>
Students are the users who will make selections.
Each student is identified by their numerical ID and belongs to a single grade.
</p>
</section>
<section class="listing">
<h2>Current students</h2>
<table>
<thead>
<tr>
<th>ID</th>
<th>Name</th>
<th>Grade</th>
<th>Legal sex</th>
<th>Actions</th>
</tr>
</thead>
<tbody>
{{ range .Students }}
<tr>
<td>{{ .ID }}</td>
<td>{{ .Name }}</td>
<td>{{ .Grade }}</td>
<td>{{ .LegalSex }}</td>
<td>
<details>
<summary>Edit</summary>
<form method="POST" action="/admin/students/edit">
<input type="hidden" name="id" value="{{ .ID }}" />
<label for="student-name-{{ .ID }}">Name:</label>
<input type="text" id="student-name-{{ .ID }}" name="name" value="{{ .Name }}" required />
<br />
<label for="student-grade-{{ .ID }}">Grade:</label>
<select id="student-grade-{{ .ID }}" name="grade" required>
{{ $student := . }}
{{ range $.Grades }}
<option value="{{ .Grade }}" {{ if eq .Grade $student.Grade }}selected{{ end }}>
{{ .Grade }}{{ if not .Enabled }} (disabled){{ end }}
</option>
{{ end }}
</select>
<br />
<label for="student-legal-sex-{{ .ID }}">Legal sex:</label>
<select id="student-legal-sex-{{ .ID }}" name="legal_sex" required>
{{ range $.LegalSexes }}
<option value="{{ . }}" {{ if eq . $student.LegalSex }}selected{{ end }}>{{ . }}</option>
{{ end }}
</select>
<br />
<input value="Submit" type="submit" />
</form>
</details>
<details>
<summary>Delete</summary>
<form method="POST" action="/admin/students/delete">
<input type="hidden" name="id" value="{{ .ID }}" />
<input value="Confirm delete" type="submit" />
</form>
</details>
<br />
</td>
</tr>
{{ end }}
</tbody>
</table>
</section>
<section class="new">
<h2>New student</h2>
<form method="POST" action="/admin/students/new">
<label for="new-student-id">ID:</label>
<input type="number" id="new-student-id" name="id" min="0" step="1" required />
<br />
<label for="new-student-name">Name:</label>
<input type="text" id="new-student-name" name="name" required />
<br />
<label for="new-student-grade">Grade:</label>
<select id="new-student-grade" name="grade" required>
{{ range .Grades }}
<option value="{{ .Grade }}">{{ .Grade }}{{ if not .Enabled }} (disabled){{ end }}</option>
{{ end }}
</select>
<br />
<label for="new-student-legal-sex">Legal sex:</label>
<select id="new-student-legal-sex" name="legal_sex" required>
{{ range .LegalSexes }}
<option value="{{ . }}">{{ . }}</option>
{{ end }}
</select>
<br />
<input value="Add" type="submit" />
</form>
</section>
<section class="import">
<h2>Import CSV</h2>
<p>
Upload a CSV to bulk-create students. Fields must appear in the following order:
<code>id,name,grade,legal_sex</code>.
</p>
<p>
Download an example file: <a href="/admin/static/students_example.csv">students_example.csv</a>
</p>
<form method="POST" action="/admin/students/import" enctype="multipart/form-data">
<label for="students-import-csv">CSV file:</label>
<input type="file" id="students-import-csv" name="csv" accept=".csv" required />
<br />
<input value="Import" type="submit" />
</form>
</section>
{{ end }}
